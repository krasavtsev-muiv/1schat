# API Документация: Учебная информационная система

## Описание

API для работы с учебной информационной системой на базе 1С:Предприятие. Предоставляет RESTful интерфейс для управления кафедрами, группами, дисциплинами, студентами и преподавателями.

## Базовый URL

```
http://localhost:3040/PD/hs/eis
```

Для продакшн окружения замените на соответствующий адрес сервера.

## Аутентификация

В текущей версии API не требует аутентификации. Все запросы выполняются без токенов или ключей.

## Формат данных

- **Content-Type**: `application/json; charset=utf-8`
- **Кодировка**: UTF-8
- Все запросы и ответы используют формат JSON

## Структура ответов

### Успешный ответ

Все успешные ответы содержат поле `success: true` и данные в поле `data`:

```json
{
  "success": true,
  "data": [...]
}
```

### Ответ об ошибке

Ошибки возвращаются со статус-кодами 400 (Bad Request) или 404 (Not Found):

```json
{
  "success": false,
  "error": "Описание ошибки"
}
```

## Эндпоинты

### Кафедры

#### GET /Departments
Получить список всех кафедр.

**Ответ:**
```json
{
  "success": true,
  "data": [
    {
      "Код": "000000001",
      "Наименование": "Кафедра информационных технологий"
    }
  ]
}
```

#### POST /Departments
Добавить новую кафедру.

**Запрос:**
```json
{
  "Наименование": "Кафедра информационных технологий"
}
```

**Ответ:**
```json
{
  "success": true,
  "message": "Кафедра успешно добавлена",
  "Код": "000000001"
}
```

---

### Группы

#### GET /Groups
Получить список всех групп с информацией о кафедрах.

**Ответ:**
```json
{
  "success": true,
  "data": [
    {
      "Код": "000000001",
      "Наименование": "ИТ-21",
      "Кафедра": "Кафедра информационных технологий"
    }
  ]
}
```

#### POST /Groups
Добавить новую группу.

**Запрос:**
```json
{
  "Наименование": "ИТ-21",
  "Кафедра": "Кафедра информационных технологий"
}
```

**Ответ:**
```json
{
  "success": true,
  "message": "Группа успешно добавлена",
  "Код": "000000001"
}
```

---

### Дисциплины

#### GET /Disciplines
Получить список всех дисциплин с информацией о кафедрах.

**Ответ:**
```json
{
  "success": true,
  "data": [
    {
      "Код": "000000001",
      "Наименование": "Основы программирования",
      "Кафедра": "Кафедра информационных технологий"
    }
  ]
}
```

#### POST /Disciplines
Добавить новую дисциплину.

**Запрос:**
```json
{
  "Наименование": "Основы программирования",
  "Кафедра": "Кафедра информационных технологий"
}
```

**Ответ:**
```json
{
  "success": true,
  "message": "Дисциплина успешно добавлена",
  "Код": "000000001"
}
```

---

### Преподаватели

#### GET /Teachers
Получить список всех преподавателей с информацией о дисциплинах.

**Ответ:**
```json
{
  "success": true,
  "data": [
    {
      "Код": "000000001",
      "Фамилия": "Иванов",
      "Имя": "Иван",
      "Отчество": "Иванович",
      "Дисциплина": "Основы программирования"
    }
  ]
}
```

#### POST /Teachers
Добавить нового преподавателя.

**Запрос:**
```json
{
  "Фамилия": "Иванов",
  "Имя": "Иван",
  "Отчество": "Иванович",
  "Дисциплина": "Основы программирования"
}
```

**Ответ:**
```json
{
  "success": true,
  "message": "Преподаватель успешно добавлен",
  "Код": "000000001"
}
```

#### GET /TeachersFull
Получить полную информацию о всех преподавателях, включая их дисциплины и список студентов по каждой дисциплине.

**Ответ:**
```json
{
  "success": true,
  "data": [
    {
      "Код": "000000001",
      "Фамилия": "Иванов",
      "Имя": "Иван",
      "Отчество": "Иванович",
      "Дисциплина": {
        "Наименование": "Основы программирования",
        "Код": "000000001"
      },
      "Студенты": [
        {
          "Код": "000000001",
          "Фамилия": "Смирнов",
          "Имя": "Алексей",
          "Отчество": "Дмитриевич",
          "Группа": "ИТ-21",
          "Кафедра": "Кафедра информационных технологий"
        }
      ]
    }
  ]
}
```

#### GET /TeachersFull/{КодПреподавателя}
Получить полную информацию о конкретном преподавателе по его коду.

**Параметры:**
- `КодПреподавателя` (path, required) - Код преподавателя

**Пример:** `GET /TeachersFull/000000001`

**Ответ:**
```json
{
  "success": true,
  "data": {
    "Код": "000000001",
    "Фамилия": "Иванов",
    "Имя": "Иван",
    "Отчество": "Иванович",
    "Дисциплина": {
      "Наименование": "Основы программирования",
      "Код": "000000001"
    },
    "Студенты": [...]
  }
}
```

---

### Студенты

#### GET /Students
Получить список всех студентов с основной информацией.

**Ответ:**
```json
{
  "success": true,
  "data": [
    {
      "Код": "000000001",
      "Фамилия": "Смирнов",
      "Имя": "Алексей",
      "Отчество": "Дмитриевич",
      "Кафедра": "Кафедра информационных технологий",
      "Группа": "ИТ-21",
      "Дисциплины": ["Основы программирования", "Базы данных"]
    }
  ]
}
```

#### POST /Students
Добавить нового студента.

**Запрос:**
```json
{
  "Фамилия": "Смирнов",
  "Имя": "Алексей",
  "Отчество": "Дмитриевич",
  "Кафедра": "Кафедра информационных технологий",
  "Группа": "ИТ-21",
  "Дисциплины": ["Основы программирования", "Базы данных"]
}
```

**Поля:**
- `Фамилия` (required) - Фамилия студента
- `Имя` (required) - Имя студента
- `Отчество` (optional) - Отчество студента
- `Кафедра` (required) - Наименование кафедры
- `Группа` (optional) - Наименование группы (должна принадлежать указанной кафедре)
- `Дисциплины` (optional) - Массив наименований дисциплин (должны принадлежать указанной кафедре)

**Ответ:**
```json
{
  "success": true,
  "message": "Студент успешно добавлен",
  "Код": "000000001"
}
```

#### GET /StudentsFull
Получить полную информацию о всех студентах, включая их дисциплины и преподавателей по каждой дисциплине.

**Ответ:**
```json
{
  "success": true,
  "data": [
    {
      "Код": "000000001",
      "Фамилия": "Смирнов",
      "Имя": "Алексей",
      "Отчество": "Дмитриевич",
      "Кафедра": "Кафедра информационных технологий",
      "Группа": "ИТ-21",
      "Дисциплины": [
        {
          "Наименование": "Основы программирования",
          "Код": "000000001",
          "Преподаватели": [
            {
              "Код": "000000001",
              "Фамилия": "Иванов",
              "Имя": "Иван",
              "Отчество": "Иванович"
            }
          ]
        }
      ]
    }
  ]
}
```

#### GET /StudentsFull/{КодСтудента}
Получить полную информацию о конкретном студенте по его коду.

**Параметры:**
- `КодСтудента` (path, required) - Код студента

**Пример:** `GET /StudentsFull/000000001`

**Ответ:**
```json
{
  "success": true,
  "data": {
    "Код": "000000001",
    "Фамилия": "Смирнов",
    "Имя": "Алексей",
    "Отчество": "Дмитриевич",
    "Кафедра": "Кафедра информационных технологий",
    "Группа": "ИТ-21",
    "Дисциплины": [...]
  }
}
```

---

### Пользователи

#### GET /Users
Получить объединенный список всех студентов и преподавателей с указанием их принадлежности.

**Ответ:**
```json
{
  "success": true,
  "data": [
    {
      "Код": "000000001",
      "Фамилия": "Смирнов",
      "Имя": "Алексей",
      "Отчество": "Дмитриевич",
      "Принадлежность": "Студент"
    },
    {
      "Код": "000000001",
      "Фамилия": "Иванов",
      "Имя": "Иван",
      "Отчество": "Иванович",
      "Принадлежность": "Преподаватель"
    }
  ]
}
```

---

## Примеры использования

### cURL

#### Получить список кафедр
```bash
curl -X GET "http://localhost:3040/PD/hs/eis/Departments" \
  -H "Content-Type: application/json; charset=utf-8"
```

#### Добавить кафедру
```bash
curl -X POST "http://localhost:3040/PD/hs/eis/Departments" \
  -H "Content-Type: application/json; charset=utf-8" \
  --data-raw '{"Наименование": "Кафедра информационных технологий"}'
```

#### Добавить студента
```bash
curl -X POST "http://localhost:3040/PD/hs/eis/Students" \
  -H "Content-Type: application/json; charset=utf-8" \
  --data-raw '{
    "Фамилия": "Смирнов",
    "Имя": "Алексей",
    "Отчество": "Дмитриевич",
    "Кафедра": "Кафедра информационных технологий",
    "Группа": "ИТ-21",
    "Дисциплины": ["Основы программирования", "Базы данных"]
  }'
```

### JavaScript (fetch)

```javascript
// Получить список студентов
fetch('http://localhost:3040/PD/hs/eis/Students', {
  method: 'GET',
  headers: {
    'Content-Type': 'application/json; charset=utf-8'
  }
})
.then(response => response.json())
.then(data => console.log(data));

// Добавить студента
fetch('http://localhost:3040/PD/hs/eis/Students', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json; charset=utf-8'
  },
  body: JSON.stringify({
    Фамилия: "Смирнов",
    Имя: "Алексей",
    Отчество: "Дмитриевич",
    Кафедра: "Кафедра информационных технологий",
    Группа: "ИТ-21",
    Дисциплины: ["Основы программирования", "Базы данных"]
  })
})
.then(response => response.json())
.then(data => console.log(data));
```

### Python (requests)

```python
import requests

# Получить список студентов
response = requests.get(
    'http://localhost:3040/PD/hs/eis/Students',
    headers={'Content-Type': 'application/json; charset=utf-8'}
)
data = response.json()
print(data)

# Добавить студента
response = requests.post(
    'http://localhost:3040/PD/hs/eis/Students',
    headers={'Content-Type': 'application/json; charset=utf-8'},
    json={
        'Фамилия': 'Смирнов',
        'Имя': 'Алексей',
        'Отчество': 'Дмитриевич',
        'Кафедра': 'Кафедра информационных технологий',
        'Группа': 'ИТ-21',
        'Дисциплины': ['Основы программирования', 'Базы данных']
    }
)
data = response.json()
print(data)
```

---

## Коды ошибок

- **200 OK** - Успешный запрос
- **400 Bad Request** - Ошибка валидации данных (не указаны обязательные поля)
- **404 Not Found** - Ресурс не найден (кафедра, группа, дисциплина и т.д.)

---

## Важные замечания

1. **Кодировка**: Все запросы должны отправляться с заголовком `Content-Type: application/json; charset=utf-8` для корректной обработки русских символов.

2. **Наименования**: При добавлении записей (студентов, групп и т.д.) используйте точные наименования существующих кафедр, групп и дисциплин, так как поиск выполняется по наименованию.

3. **Связи**: 
   - Группа должна принадлежать указанной кафедре
   - Дисциплина должна принадлежать указанной кафедре
   - Преподаватель привязывается к дисциплине
   - Студент может иметь несколько дисциплин, которые должны принадлежать его кафедре

4. **Коды**: Коды генерируются автоматически при создании записей.

---

## OpenAPI спецификация

Полная техническая документация доступна в формате OpenAPI 3.0:
- Файл: `openapi.yaml`
- Можно импортировать в Swagger UI, Postman, Insomnia и другие инструменты

Для просмотра интерактивной документации:
1. Откройте https://editor.swagger.io/
2. Импортируйте файл `openapi.yaml`
3. Или используйте локальный Swagger UI

---

## Поддержка

При возникновении вопросов или проблем обращайтесь к команде разработки.

